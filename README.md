# Real-Time Emotion Detection using CNN

This project implements a real-time emotion detection system using a Convolutional Neural Network (CNN) built with TensorFlow and Keras. The application captures video from a webcam, detects faces using MTCNN, and predicts the emotion of the detected face.

You have to download the fer2013.csv dataset file before and should be kept in the same folder with these files.
You can get dataset from this link : https://www.kaggle.com/datasets/nicolejyt/facialexpressionrecognition

## Features

  - **Real-time emotion detection** from a live webcam feed.
  - **Face detection** using the MTCNN (Multi-task Cascaded Convolutional Networks) library.
  - A **deep learning model** (CNN) for classifying emotions into 7 categories: Angry, Disgust, Fear, Happy, Sad, Surprise, and Neutral.
  - **Training script** to train the emotion recognition model from scratch on the FER2013 dataset.
  - **Visualization** of training and validation accuracy and loss curves.

## Project Structure

```
.
├── emotion_detection.py    # Main script for real-time emotion detection
├── train_model.py          # Script to train the emotion recognition model
├── fer2013.csv             # The dataset file (must be downloaded)
├── emotion_model.h5        # The trained model (generated by train_model.py)
├── training_history.png    # Training metrics plot (generated by train_model.py)
└── README.md               # This README file
```

## Requirements

You will need to have Python 3 installed, along with the following libraries:

  - TensorFlow
  - OpenCV-Python
  - MTCNN
  - Pandas
  - scikit-learn
  - Matplotlib
  - NumPy

You can install these dependencies using pip:

```bash
pip install tensorflow opencv-python mtcnn pandas scikit-learn matplotlib numpy
```

## Usage

Follow these steps to set up and run the project:

### 1\. Download the Dataset

The model is trained on the **FER2013 dataset**. You need to download the `fer2013.csv` file and place it in the root directory of the project.

You can find the dataset on Kaggle: [FER2013 Dataset]((https://www.kaggle.com/datasets/nicolejyt/facialexpressionrecognition))

### 2\. Train the Model

Before running the real-time detection, you need to train the model. Execute the `train_model.py` script:

```bash
python train_model.py
```

This script will:

1.  Load and preprocess the `fer2013.csv` data.
2.  Build and compile the CNN model.
3.  Train the model and save the weights to `emotion_model.h5`.
4.  Generate a plot of the training history named `training_history.png`.

**Note:** The training process can be computationally intensive and may take a significant amount of time, depending on your hardware.

### 3\. Run Real-Time Emotion Detection

Once the `emotion_model.h5` file has been generated, you can run the real-time detection script:

```bash
python emotion_detection.py
```

This will open a window with your webcam feed. The application will detect faces and draw a bounding box around them with the predicted emotion and a confidence score.

To quit the application, press the **'q'** key.

## Model Architecture

The emotion recognition model is a Convolutional Neural Network (CNN) with the following architecture:

  - **Input Shape:** 48x48x1 grayscale images.
  - **Convolutional Blocks (3x):**
    1.  `Conv2D` (64 filters, 3x3 kernel, ReLU activation) -\> `BatchNormalization` -\> `MaxPooling2D` -\> `Dropout`
    2.  `Conv2D` (128 filters, 3x3 kernel, ReLU activation) -\> `BatchNormalization` -\> `MaxPooling2D` -\> `Dropout`
    3.  `Conv2D` (256 filters, 3x3 kernel, ReLU activation) -\> `BatchNormalization` -\> `MaxPooling2D` -\> `Dropout`
  - **Fully Connected Layers:**
      - `Flatten`
      - `Dense` (512 units, ReLU activation) -\> `BatchNormalization` -\> `Dropout`
  - **Output Layer:**
      - `Dense` (7 units, Softmax activation) for the 7 emotion classes.

The model is compiled with the `Adam` optimizer and `categorical_crossentropy` loss function. It also utilizes `EarlyStopping` and `ReduceLROnPlateau` callbacks to prevent overfitting and improve training efficiency.
